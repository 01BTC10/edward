<!doctype html>
<html>
    <head>
        <title>Console</title>
        
        <link rel="stylesheet" href="/style.css">
    </head>
    <body>
        <div class="edit" data-name="js-edit"></div>
        <script src="/edward/edward.js"></script>
        <script>
            (function() {
                'use strict';
                
                window.addEventListener('DOMContentLoaded', function domLoad() {
                    var el = document.querySelector('[data-name="js-edit"]');
                    
                    edward(el, function() {
                        el.style.fontFamily = 'Droid Sans Mono';
                        el.style.fontSize   = '16px';
                        
                        addCommands();
                        
                        load.json('/file', function(error, result) {
                            var name, data;
                            
                            if (error) {
                                alert(error);
                            } else {
                                name    = result.name;
                                data    = result.data;
                                
                                edward
                                    .setModeForPath(name)
                                    .setValueFirst(name, data);
                            }
                            
                            edward
                                .clearSelection()
                                .moveCursorTo(0, 0)
                        });
                    });
                    
                    function addCommands() {
                        edward.addCommand({
                            name    : 'goToLine',
                            bindKey : { win: 'Ctrl-G',  mac: 'Command-G' },
                            exec    : function () {
                                edward.goToLine();
                            }
                        });
                        
                        edward.addCommand({
                            name    : 'save',
                            bindKey : { win: 'Ctrl-S',  mac: 'Command-S' },
                            exec    : function() {
                                edward.save();
                            }
                        });
                        
                        edward.addCommand({
                            name    : 'saveMC',
                            bindKey : { win: 'F2',  mac: 'F2' },
                            exec    : function() {
                                edward.save();
                            }
                        });
                        
                        edward.addCommand({
                            name    : 'beautify',
                            bindKey : { win: 'Ctrl-B',  mac: 'Command-B' },
                            exec    : function() {
                                edward.beautify();
                            }
                        });
                        
                        edward.addCommand({
                            name    : 'minify',
                            bindKey : { win: 'Ctrl-M',  mac: 'Command-M' },
                            exec    : function() {
                                edward.minify();
                            }
                        });
                    }
                    
                    window.removeEventListener('DOMContentLoaded', domLoad);
                });
            })()
        </script>
    </body>
</html>
